@page "/authentication/{action}"
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using System.Security.Claims
@inject AuthenticationStateProvider AuthenticationStateProvider

<Content>
    <ChildContent>
        <RemoteAuthenticatorView Action="@Action" OnLogInSucceeded="@OnLoginSuccess"/>
    </ChildContent>
</Content>

@code {

    [Parameter]
    public string? Action { get; set; }

    private IEnumerable<Claim> claims = Enumerable.Empty<Claim>();
    
    private async void OnLoginSuccess()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        if (user.Identity is not {IsAuthenticated: true }) return;
        claims = user.Claims;
        var oidClaim = _getClaim("oid");
        var emailClaim = _getClaim("email");
        var name = user.Identity.Name;
    }

    private string? _getClaim(string type)
    {
        return claims.FirstOrDefault(c => c.Type.Equals(type))?.Value;
    }

}